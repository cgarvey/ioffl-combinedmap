
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
<title>Broadband viewer</title>
<link rel=stylesheet href='form_demo23.css' type='text/css'>

<style type="text/css">
  #map_canvas { height: 100% }
</style> 




<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">

var marker = "null"
var PlatQry="";
var NetQry="Network NOT EQUAL TO 'F' ";
var CombQry="";
var currentLayer = null;
var layer = null;
var layer1 = null;
var layer2 = null;
var exchQry ="";
var circle = null;
var crosshair = null

function initialize() 
{
  				// Set centre of map
    var athlone = new google.maps.LatLng(53.5, -7.5);
    
    			// Set background map, centre, zoom level, type 
		map = new google.maps.Map(document.getElementById('map_canvas'), {
		center: athlone,
		zoom: 7,
		mapTypeId: 'roadmap'

});
 
				// Add a Circle overlay to the map.
		circle = new google.maps.Circle({
		map: map,
		radius: 4500, // 4.5 kms
		strokeWeight: 0,
		stokeOpacity: 0
});
  
		crosshair = new google.maps.MarkerImage('clear%20black%20dot%20med.png',
				// This marker is 10 pixels wide by 10 pixels tall.
		  new google.maps.Size(10, 10),
				  // The origin for this image is 0,0.
		  new google.maps.Point(0,0),
				  // The anchor for this image is at the base at 5,5.
		  new google.maps.Point(5, 5));

		marker = new google.maps.Marker({
		  icon: crosshair,		
		  map: map,
		  position: new google.maps.LatLng(53.5, -10.5),
		  draggable: true,
		  title: 'Drag to your location'
        });
	        circle.bindTo('center', marker, 'position');
}
function fetchMarker()
{
 	 marker.position = map.getCenter(),
     circle.bindTo('center', marker, 'position');
 	 marker.setMap(map);
}


function formScan(formVar,formName,txtOut)
{
  var formVar=document.formName.formVar;
  var i;
  
  txtOut="";

	  for (i=0;i<formVar.length;i++)
		{
		if (formVar[i].checked)
		  txtOut=txtOut + formVar[i].value;
		else
		  txtOut=txtOut + "";
		}
} 
function PlatQueryTxt()
{
  var platform=document.technology.platform;
  var i;
  
  PlatQry="";

	  for (i=0;i<platform.length;i++)
		{
		if (platform[i].checked)
		  PlatQry=PlatQry + platform[i].value;
		else
		  PlatQry=PlatQry + "";
		}
} 

function NetQuery()
{
  var sites=document.providers.sites;
  var i;
  NetQry="";

	  for (i=0;i<sites.length;i++)
		{
		if (sites[i].checked)
		  NetQry=NetQry + sites[i].value;
		else
		  NetQry=NetQry + "";		
		}
}
function ExchQry()
{
  var exchange = document.eircom.exchange;
  var i;
  exchQry="";
	  for (i=0;i<exchange.length;i++)
		{
		if (exchange[i].checked)
		  exchQry=exchQry + exchange[i].value ;

		else
		  exchQry=exchQry + "";
		}
} 

function MakeQuery()
{
  	CombQry =""
	
  	NetQuery();
	PlatQueryTxt();
	CombQry = "'Network' IN (" + NetQry + "'f')" + PlatQry;
	
	currentLayer=layer2
	clearLayer();
		
	layer2 = new google.maps.FusionTablesLayer(5488684, {
		query: "SELECT  Location FROM 5488684 WHERE " + CombQry});
	stackLayers();
	currentLayer = layer2;

}


function compQuery()
{
		currentLayer = layer;
 clearLayer(); 
 ExchQry(); 
 exchQry="(" + exchQry +"'f')";
 layer = new google.maps.FusionTablesLayer(1888694, {
 query: "SELECT  Location FROM 1888694 WHERE 'Enabled' IN" + exchQry});
   		stackLayers(); 		
		currentLayer = layer;
}

function overlay(layerNo,dataset,querytxt)
{
		currentLayer = layerNo;   
		clearLayer();
	  	layer1 = new google.maps.FusionTablesLayer(dataset, {
			query: querytxt});
		stackLayers();
		currentLayer = layerNo;   	
}
function stackLayers()
{
  if (layer1 != null) {
  layer1.setMap(map);}

  if (layer != null) {
  layer.setMap(map);}

  if (layer2 !=null) {
  layer2.setMap(map);}


}
function clearLayer() 
{
    if (currentLayer != null) {
      currentLayer.setMap(null);
    }
}

</script>
</head>
<body onload="initialize()">

<div id="Form" class="form">
<form id="Network" name="providers">
  	<fieldset>
		<legend>Network</legend>
		<ol>
		  <li>
			  <label for="Vodafone">Vodafone  </label><img src="small%20red%20dot.png"/>
			  <input id="Vodafone" class="shift" onclick="MakeQuery()" type="checkbox" name="sites" value="'Vodafone',"><br />
		  </li>
		  <li>
			  <label for="O2">O2  </label><img src="small%20blue%20dot.png"/>
			  <input id="O2" class="shift" onclick="MakeQuery()" type="checkbox" name="sites" value="'O2',"><br />
		  </li>
		  <li>
			  <label for="Meteor">Meteor  </label><img src="small%20yellow%20dot.png"/>
			  <input id="Meteor" class="shift" onclick="MakeQuery()" type="checkbox" name="sites" value="'Meteor',"><br />
		  </li>
		  <li class="bottomli">
			  <label for="3">3  </label><img src="vsmall%20green%20dot.png"/><label> NBS </label><img src="vsmal%20purple%20dot.png"/>
			  <input id="3" class="shift" onclick="MakeQuery()" type="checkbox" name="sites" value="'3',"><br />
		  </li>
		</ol>
</fieldset>
</form>

<form id="Platform" name = "technology">
	<fieldset>
		<legend>Platform</legend>
		<ol>
			<li>
				<label for=GSM>GSM</label>
				<input class="shift" onclick="MakeQuery()" id="GSM" name="platform" type="checkbox" value=" AND GSM = 'X'">
			</li>
			<li class="bottomli">
				<label for=3G>3G (Midband)</label>
				<input class="shift" onclick="MakeQuery()" id="3G" name="platform" type="checkbox" value=" AND UMTS = 'X'">
			</li>
					
		</ol>
	</fieldset>
</form>
  
<form id="Eircom" name= "eircom" >
	<fieldset>
		<legend>Eircom</legend>
		<ol>
			<li>
				<label for=DSL>DSL  </label><img src="vsmall%20white%20dot.png"/>
				<input class="shift" onclick="compQuery()" id="DSL" name="exchange" type="checkbox" value="'y',">
			</li>
			<li class="bottomli">
				<label for=nonDSL>not DSL  </label><img src="vsmall%20grey%20dot.png"/>
				<input class="shift" onclick="compQuery()" id="nonDSL" name="exchange" type="checkbox" value="'n',">
			</li>
		</ol>
	</fieldset>
</form>

<form id="AreaOverlay">
	<fieldset>
		<legend>Underlays</legend>
		<ol><li>
				<label for=Urban>Urban</label>
				<input class="shift" onclick="overlay(layer1,1236159,'SELECT KML FROM 1236159 WHERE Urban = \u0027X\u0027')" id="UrbanAreas" name="area" type="radio" value="1236159">
				</li>
			<li>
				<label for=NBS>NBS</label>
				<input class="shift" onclick="overlay(layer1,848418,'SELECT KML FROM 848418')" id="NBSAreas" name="area" type="radio" value="848418">
				</li>
			<li>
				<label for=Counties>Counties</label>
				<input class="shift" onclick="overlay(layer1,1242110,'SELECT KML FROM 1242110')" id="Counties" name="area" type="radio" value="1242110">
				</li>				
			<li >
				<label for=Eircom>Exchanges</label>
				<input class="shift" onclick="overlay(layer1,1214572,'SELECT KML FROM 1214572')" id="Eircom" name="area" type="radio" value="1214572">
				</li>
			<li class="bottomli">
				<label for=IntConnX>International</label>
				<input class="shift" onclick="overlay(layer1,1412833,'SELECT coordinates FROM 1412833')" id="IntConnX" name="area" type="radio" value="1412833">
				</li>
		</ol>
	</fieldset>
</form>

<fieldset>
<input type="button" class="centreform"  onclick="fetchMarker()" value="Fetch Marker">
</fieldset>
</div>
<div id="map_canvas" ></div>

</body>
</html>

